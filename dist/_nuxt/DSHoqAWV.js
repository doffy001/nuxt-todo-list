import{L as O,M as R,N as T,r as w,O as B,z as u,d as E,P as S,A as g,t as P,Q as t,R as h,S as N,T as _,x as i,y as k,B as c,C as U,D as j,q as D,_ as L}from"./CFs3CkJe.js";import{m as M,c as $,f as A,V as q,a as v,b as C,u as I,d as V}from"./SWK10EN-.js";const J=O({...R(),...M()},"VForm"),F=T()({name:"VForm",props:J(),emits:{"update:modelValue":l=>!0,submit:l=>!0},setup(l,b){let{slots:r,emit:s}=b;const d=$(l),n=w();function y(o){o.preventDefault(),d.reset()}function x(o){const e=o,a=d.validate();e.then=a.then.bind(a),e.catch=a.catch.bind(a),e.finally=a.finally.bind(a),s("submit",e),e.defaultPrevented||a.then(m=>{var f;let{valid:p}=m;p&&((f=n.value)==null||f.submit())}),e.preventDefault()}return B(()=>{var o;return u("form",{ref:n,class:["v-form",l.class],style:l.style,novalidate:!0,onReset:y,onSubmit:x},[(o=r.default)==null?void 0:o.call(r,d)])}),A(d,n)}}),Q=l=>(U("data-v-46bef531"),l=l(),j(),l),W=Q(()=>i("h1",{class:"mb-2"},"Todo list app",-1)),z={class:"d-flex justify-center mb-3"},G={class:"text-center"},X={class:"d-flex justify-center mb-3"},H={class:"text-center"},K=E({__name:"index",setup(l){const b=w(!0),r=w({email:"",password:""}),s=w({email:"",name:"",password:"",confirmPassword:""}),d=w(""),n=w(""),y=async()=>{var o;try{const{data:e,error:a}=await I("/api/login",{method:"POST",body:JSON.stringify(r.value)},"$pqtWcjQkdb");if(a.value)throw new Error(a.value.data.message);if(e.value){const m=new Date;m.setDate(m.getDate()+1);const p=V("userId",{expires:m}),f=V("userName",{expires:m});p.value=(o=e.value.userId)==null?void 0:o.toString(),f.value=e.value.userName,await D("/todos")}}catch(e){const a=e;d.value=(a==null?void 0:a.message)||""}},x=async()=>{var o;if(!(s.value.email&&s.value.name&&s.value.password&&s.value.confirmPassword))return n.value="All fields have to be filled.",!1;if(s.value.password!==s.value.confirmPassword)return n.value="Wrong password.",!1;try{const e=new Date;e.setDate(e.getDate()+1);const a=V("userId",{expires:e}),m=V("userName",{expires:e}),{data:p,error:f}=await I("/api/signup",{method:"POST",body:JSON.stringify(s.value)},"$cmRBlMwAGX");if(f.value)throw new Error(f.value.data.message);p.value&&(a.value=(o=p.value.userId)==null?void 0:o.toString(),m.value=p.value.userName,await D("/todos"))}catch(e){const a=e;n.value=(a==null?void 0:a.message)||""}};return(o,e)=>(P(),S(q,{class:"pa-4"},{default:g(()=>[W,t(b)?(P(),S(F,{key:0,onSubmit:h(y,["prevent"])},{default:g(()=>[u(v,{modelValue:t(r).email,"onUpdate:modelValue":e[0]||(e[0]=a=>t(r).email=a),label:"Email",type:"email"},null,8,["modelValue"]),u(v,{modelValue:t(r).password,"onUpdate:modelValue":e[1]||(e[1]=a=>t(r).password=a),label:"Password",type:"password"},null,8,["modelValue"]),N(i("p",{class:"error-message mb-2 text-center"},k(t(d)),513),[[_,t(d)]]),i("div",z,[u(C,{type:"submit"},{default:g(()=>[c("Login")]),_:1})]),i("p",G,[c("Or if you don't have an account, "),i("a",{href:"javascript:;",onClick:e[2]||(e[2]=a=>b.value=!1)},"sign up"),c(" instead.")])]),_:1})):(P(),S(F,{key:1,onSubmit:h(x,["prevent"])},{default:g(()=>[u(v,{modelValue:t(s).email,"onUpdate:modelValue":e[3]||(e[3]=a=>t(s).email=a),label:"Email",type:"email"},null,8,["modelValue"]),u(v,{modelValue:t(s).name,"onUpdate:modelValue":e[4]||(e[4]=a=>t(s).name=a),label:"Name"},null,8,["modelValue"]),u(v,{modelValue:t(s).password,"onUpdate:modelValue":e[5]||(e[5]=a=>t(s).password=a),label:"Password",type:"password"},null,8,["modelValue"]),u(v,{modelValue:t(s).confirmPassword,"onUpdate:modelValue":e[6]||(e[6]=a=>t(s).confirmPassword=a),label:"Confirm Password",type:"password"},null,8,["modelValue"]),N(i("p",{class:"error-message mb-2 text-center"},k(t(n)),513),[[_,t(n)]]),i("div",X,[u(C,{type:"submit"},{default:g(()=>[c("Sign up")]),_:1})]),i("p",H,[c("Or if you have an account, "),i("a",{href:"javascript:;",onClick:e[7]||(e[7]=a=>b.value=!0)},"log in"),c(" instead.")])]),_:1}))]),_:1}))}}),ee=L(K,[["__scopeId","data-v-46bef531"]]);export{ee as default};
